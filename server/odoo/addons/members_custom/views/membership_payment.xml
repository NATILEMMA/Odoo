<?xml version="1.0"?>

<odoo>

    <record id="payment_fee_configuration_tree" model="ir.ui.view">
        <field name="name">Members' Fee</field>
        <field name="model">payment.fee.configuration</field>
        <field name="arch" type="xml">
            <tree editable="top">
                <field name="sequence" widget="handle"/>
                <field name="id"/>
                <field name="minimum_wage"/>
                <field name="maximum_wage"/>
                <field name="fee_in_percent"/>
            </tree>
        </field>
    </record>

    <record id="payment_fee_configuration_action" model="ir.actions.act_window">
        <field name="name">Members' Fee</field>
        <field name="res_model">payment.fee.configuration</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="each_member_payment_tree" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">each.member.payment</field>
        <field name="arch" type="xml">
            <tree editable="top">
                <field name="wereda_id" invisible="1"/>
                <field name="members_payment_id" invisible="1"/>
                <field name="member_id" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="year" invisible="1"/>
                <field name="month" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="cell_id" readonly="1"/>
                <field name="fee_amount" readonly="1"/>
                <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="amount_remaining" readonly="1" force_save="1"/>
                <field name="traced_member_payment" readonly="1" force_save="1"/>
                <field name="type_of_payment" readonly="1" optional="hidden"/>
                <field name="paid" invisible="1"/>
                <field name="id_payment"/>
                <field name="state"/>
                <button name="print_payslip" string="Pay Slip" type="object" icon="fa-download" attrs="{'invisible': [('state', '=', 'not payed')]}" confirm="Are you sure you want to print payslips?"/>
            </tree>
        </field>
    </record>

    <record id="each_member_payment_form" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">each.member.payment</field>
        <field name="arch" type="xml">
            <form duplicate="false">
                <sheet>
                    <group>
                        <group>
                            <field name="wereda_id" invisible="1"/>
                            <field name="month" options="{'no_create': True, 'no_create_edit': True}" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                            <field name="year"/>
                            <field name="member_id" options="{'no_create': True, 'no_create_edit': True}" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1" context="{'form_view_ref': 'members_custom.membership_view_partner_form'}"/>
                            <field name="fee_amount"/>
                            <field name="type_of_payment" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="members_payment_id" invisible="1"/>
                        </group>
                        <group>
                            <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="amount_remaining" force_save="1" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="id_payment"/>
                            <field name="traced_member_payment" force_save="1" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="annual_fee" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="state"/>
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="each_member_payment_search" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">each.member.payment</field>
        <field name="arch" type="xml">
            <search string="Members' Payment">
                <group expand="0" string="Group By" colspan="10" col="8">
                    <filter string="Month" name="month" context="{'group_by': 'month'}"/>
                    <filter string="Year" name="year" context="{'group_by': 'year'}"/>
                    <filter string="Name" name="name" context="{'group_by': 'member_id'}"/>
                    <filter string="Main Office" name="office" context="{'group_by': 'main_office_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="each_member_payment_tree_report" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">each.member.payment</field>
        <field name="arch" type="xml">
            <tree create="false" edit="false" delete="false" duplicate="false">
                <field name="member_id"/>
                <field name="year" invisible="1"/>
                <field name="month"/>
                <field name="cell_id"/>
                <field name="fee_amount"/>
                <field name="amount_paid"/>
                <field name="amount_remaining"/>
                <field name="id_payment"/>
                <field name="type_of_payment"/>
            </tree>
        </field>
    </record>

    <record id="each_member_payment_menu" model="ir.actions.act_window">
        <field name="name">Members' Payment</field>
        <field name="res_model">each.member.payment</field>
        <field name="view_mode">tree,pivot,graph</field>
        <field name="search_view_id" ref="each_member_payment_search"/>
        <field name="view_id" ref="each_member_payment_tree_report"/>
        <field name="domain">['|', '|', '|', '|', ('wereda_id.branch_manager', '=', uid), ('subcity_id.parent_manager.id', '=', uid), ('subcity_id.city_id.city_manager', 'in', [uid]), ('subcity_id.city_id.transfer_handler', '=', uid), ('subcity_id.city_id.responsible_id.system_admin', '=', uid)]</field>
    </record>

    <record id="each_league_payment_tree" model="ir.ui.view">
        <field name="name">Leagues' Payments</field>
        <field name="model">each.league.payment</field>
        <field name="arch" type="xml">
            <tree editable="top">
                <field name="wereda_id" invisible="1"/>
                <field name="members_payment_id" invisible="1"/>
                <field name="league_id" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="year" invisible="1"/>
                <field name="month" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="cell_id" readonly="1"/>
                <field name="league_type"/>
                <field name="league_org" optional="hidden"/>
                <field name="fee_amount" readonly="1"/>
                <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                <field name="amount_remaining" readonly="1" force_save="1"/>
                <field name="traced_league_payment" readonly="1" force_save="1"/>
                <field name="type_of_payment" readonly="1" optional="hidden"/>
                <field name="id_payment"/>
                <field name="paid" invisible="1"/>
                <field name="state"/>
                <button name="print_league_payslip" string="Pay Slip" type="object" icon="fa-download" attrs="{'invisible': [('state', '=', 'not payed')]}" confirm="Are you sure you want to print payslips?"/>
            </tree>
        </field>
    </record>

    <record id="each_league_payment_form" model="ir.ui.view">
        <field name="name">Leagues' Payment</field>
        <field name="model">each.league.payment</field>
        <field name="arch" type="xml">
            <form duplicate="false">
                <sheet>
                    <group>
                        <group>
                            <field name="wereda_id" invisible="1"/>
                            <field name="month" options="{'no_create': True, 'no_create_edit': True}" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                            <field name="year"/>
                            <field name="league_id" options="{'no_create': True, 'no_create_edit': True}" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1" context="{'form_view_ref': 'members_custom.membership_view_partner_form'}"/>
                            <field name="fee_amount"/>
                            <field name="type_of_payment" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="members_payment_id" invisible="1"/>
                        </group>
                        <group>
                            <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="amount_remaining" force_save="1" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="id_payment"/>
                            <field name="traced_league_payment" force_save="1" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="annual_league_fee" attrs="{'readonly': [('state', '=', 'paid')]}"/>
                            <field name="state"/>
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="each_league_payment_search" model="ir.ui.view">
        <field name="name">Leagues' Payment</field>
        <field name="model">each.league.payment</field>
        <field name="arch" type="xml">
            <search string="Leagues' Payment">
                <group expand="0" string="Group By" colspan="10" col="8">
                    <filter string="Month" name="month" context="{'group_by': 'month'}"/>
                    <filter string="Year" name="year" context="{'group_by': 'year'}"/>
                    <filter string="Name" name="name" context="{'group_by': 'league_id'}"/>
                    <filter string="Main Office" name="office" context="{'group_by': 'main_office_id'}"/>
                    <filter string="League Type" name="type" context="{'group_by': 'league_type'}"/>
                    <filter string="League Organization" name="org" context="{'group_by': 'league_org'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="each_league_payment_tree_report" model="ir.ui.view">
        <field name="name">Leagues' Payment</field>
        <field name="model">each.league.payment</field>
        <field name="arch" type="xml">
            <tree create="false" edit="false" delete="false" duplicate="false">
                <field name="league_id"/>
                <field name="year"/>
                <field name="month"/>
                <field name="league_type"/>
                <field name="league_org"/>
                <field name="fee_amount"/>
                <field name="amount_paid"/>
                <field name="amount_remaining"/>
                <field name="id_payment"/>
                <field name="type_of_payment"/>
            </tree>
        </field>
    </record>

    <record id="each_league_payment_menu" model="ir.actions.act_window">
        <field name="name">Leagues' Payment</field>
        <field name="res_model">each.league.payment</field>
        <field name="view_mode">tree,pivot,graph</field>
        <field name="search_view_id" ref="each_league_payment_search"/>
        <field name="view_id" ref="each_league_payment_tree_report"/>
        <field name="domain">['|', '|', '|', '|', ('wereda_id.branch_manager', '=', uid), ('subcity_id.parent_manager.id', '=', uid), ('subcity_id.city_id.city_manager', 'in', [uid]), ('subcity_id.city_id.transfer_handler', '=', uid), ('subcity_id.city_id.responsible_id.system_admin', '=', uid)]</field>
    </record>

    <record id="donation_payment_tree" model="ir.ui.view">
        <field name="name">Donors Payment</field>
        <field name="model">donation.payment</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="user_id" invisible="1"/>
                <field name="year"/>
                <field name="month"/>
                <field name="amount"/>
                <field name="donor_ids"/>
                <field name="supporter_id"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="donation_payment_form" model="ir.ui.view">
        <field name="name">Donors Payment</field>
        <field name="model">donation.payment</field>
        <field name="arch" type="xml">
            <form duplicate="false">
                <header>
                    <button name="draft_button" string="Go Back To Draft" states="submit" type="object" class="oe_highlight" confirm="Are you sure you want to go back to draft?"/>
                    <button name="submit_button" string="Submit" type="object" states="draft" class="oe_highlight" confirm="Are you sure you want to submit payments?"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,submit,registered"/>
                </header>
                <sheet>
                    <h1>
                        <field name="name"/>
                    </h1>
                    <field name="x_css" invisible="1"/>
                    <group>
                        <group>
                            <field name="user_id" invisible="1"/>
                            <field name="year" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="month" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="for_donor_or_supporter"/>
                            <field name="donor_ids" attrs="{'invisible': [('for_donor_or_supporter', '=', 'supporter')], 'required': [('for_donor_or_supporter', '=', 'donor')], 'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="supporter_id" attrs="{'invisible': [('for_donor_or_supporter', '=', 'donor')], 'required': [('for_donor_or_supporter', '=', 'supporter')], 'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="product_cash" attrs="{'readonly': [('state', 'not in', 'draft')]}"/>
                            <field name="amount" force_save="1" attrs="{'readonly': [('product_cash', '=', 'product')]}"/>
                        </group>
                        <group>
                            <field name="payment_for"/>
                            <field name="city" attrs="{'readonly': [('state', 'not in', 'draft')]}" required="1" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="subcity_id" attrs="{'invisible': [('payment_for', '=', 'city')], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for', '!=', 'city')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="wereda_id" attrs="{'invisible': [('payment_for', 'in', ['city', 'subcity'])], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for', 'not in', ['city', 'subcity'])]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="main_office" attrs="{'invisible': [('payment_for', 'in', ['city', 'subcity', 'wereda'])], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for', 'not in', ['city', 'subcity', 'wereda'])]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="member_cell" attrs="{'invisible': [('payment_for', 'in', ['city', 'subcity', 'wereda', 'main office'])], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for', 'not in', ['city', 'subcity', 'wereda', 'main office'])]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <button name="print_donor_payslip" string="Pay Slip" class="btn-info" type="object" icon="fa-download" attrs="{'invisible': [('state', '!=', 'submit')]}" confirm="Are you sure you want to print payslips?"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Products" name="product_ids" attrs="{'invisible': [('product_cash', '=', 'cash')]}">
                            <field name="product_ids">
                                <tree editable="bottom" delete="true">
                                    <field name="product_id"/>
                                    <field name="cost" force_save="1"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Reason for Donation" name="reason">
                            <field name="reason"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="donor_payment_action" model="ir.actions.act_window">
        <field name="name">Donors Payment</field>
        <field name="res_model">donation.payment</field>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="domain">['|', '|', '|', '|', '|', '|', '|',
                            ('member_cell.cell_admin', '=', uid),
                            ('member_cell.cell_finance', '=', uid),
                            ('main_office.main_admin', '=', uid),
                            ('main_office.main_finance', '=', uid),
                            ('wereda_id.branch_manager', '=', uid),
                            ('subcity_id.parent_manager.id', '=', uid),
                            ('city.city_manager', 'in', [uid]),
                            ('city.responsible_id.system_admin', '=', uid)]</field>
    </record>


    <record id="membership_cell_payment_tree" model="ir.ui.view">
        <field name="name">Members' Cell Payment</field>
        <field name="model">membership.cell.payment</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="user_id" invisible="1"/>
                <field name="main_office_payment" invisible="1"/>
                <field name="year"/>
                <field name="month"/>
                <field name="member_cell"/>
                <field name="league_cell"/>
                <field name="wereda_id"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="membership_cell_payment_form" model="ir.ui.view">
        <field name="name">Members' Cell Payment</field>
        <field name="model">membership.cell.payment</field>
        <field name="arch" type="xml">
            <form duplicate="false">
                <header>
                    <button name="start_button" string="Start Payments" states="draft" type="object" class="oe_highlight" confirm="Are you sure you want to Start Payments?"/>
                    <button name="submit_button" string="Submit" type="object" states="pending payments" class="oe_highlight" confirm="Are you sure you want to Submit Payments?"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,pending payments,submit,registered"/>
                </header>
                <sheet>
                    <h1>
                        <field name="name"/>
                    </h1>
                    <field name="x_css" invisible="1"/>
                    <group>
                        <group>
                            <field name="user_id" invisible="1"/>
                            <field name="main_office_payment" invisible="1"/>
                            <field name="year" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="month" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="payment_for_league_member" string="League or Member" attrs="{'readonly': [('state', 'not in', 'draft')]}"/>
                        </group>
                        <group>
                            <field name="subcity_id" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="wereda_id" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="main_office" attrs="{'readonly': [('state', 'not in', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="member_cell" attrs="{'invisible': [('payment_for_league_member', '=', 'league')], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for_league_member', '=', 'member')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="league_cell" attrs="{'invisible': [('payment_for_league_member', '=', 'member')], 'readonly': [('state', 'not in', 'draft')], 'required': [('payment_for_league_member', '=', 'league')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="amount" attrs="{'readonly': [('state', 'not in', 'draft')]}"/>
                            <field name="estimated_amount_remaining" force_save="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Members" name="members_ids" attrs="{'invisible': ['|', ('payment_for_league_member', '=', 'league'), ('state', '=', 'draft')], 'readonly': [('state', '=', 'submit')]}">
                            <field name="member_ids" attrs="{'readonly': [('state', '=', 'submit')]}">
                                <tree editable="top" delete="false">
                                    <field name="wereda_id" invisible="1"/>
                                    <field name="members_payment_id" invisible="1"/>
                                    <field name="member_id" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="year" invisible="1"/>
                                    <field name="month" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="cell_id" readonly="1" invisible="1"/>
                                    <field name="fee_amount" readonly="1"/>
                                    <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="amount_remaining" readonly="1" force_save="1"/>
                                    <field name="traced_member_payment" readonly="1" force_save="1"/>
                                    <field name="type_of_payment" readonly="1"/>
                                    <field name="id_payment"/>
                                    <field name="state" readonly="1" force_save="1"/>
                                    <button name="print_payslip" string="Pay Slip" type="object" icon="fa-download" attrs="{'column_invisible': [('parent.state', 'in', ['draft'])]}" confirm="Are you sure you want to print payslips?"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" attrs="{'invisible': ['|', ('payment_for_league_member', '=', 'league'), ('state', '=', 'draft')]}">
                                <field name="total_estimated_for_members" widget="monetary" force_save="1"/>
                                <field name="total_remaining_for_members" widget="monetary" force_save="1"/>
                                <field name="total_paid_for_members" widget="monetary" force_save="1"/>
                                <field name="total_id_payments_members" widget="monetary" force_save="1"/>
                            </group>
                        </page>
                        <page string="Leagues" name="league_ids" attrs="{'invisible': ['|', ('payment_for_league_member', '=', 'member'), ('state', '=', 'draft')], 'readonly': [('state', '=', 'submit')]}">
                            <field name="league_ids" attrs="{'readonly': [('state', '=', 'submit')]}">
                                <tree editable="top" delete="false">
                                    <field name="wereda_id" invisible="1"/>
                                    <field name="members_payment_id" invisible="1"/>
                                    <field name="league_id" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="year" invisible="1"/>
                                    <field name="month" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="cell_id" readonly="1" invisible="1"/>
                                    <field name="league_type"/>
                                    <field name="league_org" optional="hidden"/>
                                    <field name="fee_amount" readonly="1"/>
                                    <field name="amount_paid" attrs="{'readonly': [('state', '=', 'paid')]}" force_save="1"/>
                                    <field name="amount_remaining" readonly="1" force_save="1"/>
                                    <field name="traced_league_payment" readonly="1" force_save="1"/>
                                    <field name="type_of_payment" readonly="1"/>
                                    <field name="id_payment"/>
                                    <field name="state" readonly="1" force_save="1"/>
                                    <button name="print_league_payslip" string="Pay Slip" type="object" icon="fa-download" attrs="{'column_invisible': [('parent.state', 'in', ['draft'])]}" confirm="Are you sure you want to print payslips?"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" attrs="{'invisible': ['|', ('payment_for_league_member', '=', 'member'), ('state', '=', 'draft')]}">
                                <field name="total_estimated_for_leagues" widget="monetary" force_save="1"/>
                                <field name="total_remaining_for_leagues" widget="monetary" force_save="1"/>
                                <field name="total_paid_for_leagues" widget="monetary" force_save="1"/>
                                <field name="total_id_payments_leagues" widget="monetary" force_save="1"/>                 
                            </group>
                        </page>
                        <page string="Donors" name="donor_ids" attrs="{'invisible': [('state', '=', 'draft')], 'readonly': [('state', '=', 'submit')]}">
                            <field name="donor_ids" attrs="{'readonly': [('state', '=', 'submit')]}">
                                <tree delete="false">
                                    <field name="name"/>
                                    <field name="donor_ids"/>
                                    <field name="supporter_id"/>
                                    <field name="year"/>
                                    <field name="month"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" attrs="{'invisible': [('state', '=', 'draft')]}">
                                <field name="total_donors" widget="monetary" force_save="1"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="membership_cell_payment_graph" model="ir.ui.view">
        <field name="name">Cell Payment</field>
        <field name="model">membership.cell.payment</field>
        <field name="arch" type="xml">
            <graph string="Cell Payment">
                <field name="month"/>
                <field name="amount" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="membership_cell_payment_action" model="ir.actions.act_window">
        <field name="name">Members' Cell Payment</field>
        <field name="res_model">membership.cell.payment</field>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="domain">['|', '|', '|', '|', '|', '|', '|', '|', '|', '|',
                            ('member_cell.cell_admin', '=', uid),
                            ('member_cell.cell_finance', '=', uid),
                            ('league_cell.cell_admin', '=', uid),
                            ('league_cell.cell_finance', '=', uid),                            
                            ('main_office.main_admin', '=', uid),
                            ('main_office.main_finance', '=', uid),
                            ('wereda_id.branch_manager', '=', uid),
                            ('subcity_id.parent_manager.id', '=', uid),
                            ('subcity_id.city_id.city_manager', 'in', [uid]),
                            ('subcity_id.city_id.transfer_handler', '=', uid), 
                            ('subcity_id.city_id.responsible_id.system_admin', '=', uid)]</field>
    </record>


    <record id="membership_payment_tree" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">membership.payment</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="user_id" invisible="1"/>
                <field name="year"/>
                <field name="month"/>
                <field name="main_office"/>
                <field name="wereda_id"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="membership_payment_form" model="ir.ui.view">
        <field name="name">Members' Payment</field>
        <field name="model">membership.payment</field>
        <field name="arch" type="xml">
            <form duplicate="false">
                <header>
                    <button name="start_button" string="Start Payments" states="draft" type="object" class="oe_highlight" confirm="Are you sure you want to Start Payments?"/>
                    <button name="draft_button" string="Go Back To Draft" states="submit" type="object" class="oe_highlight" confirm="Are you sure you want to go Back to Draft?"/>
                    <button name="submit_button" string="Submit" type="object" states="pending payments" class="oe_highlight" confirm="Are you sure you want to Submit Payments?"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,pending payments,submit,registered"/>
                </header>
                <sheet>
                    <h1>
                        <field name="name"/>
                    </h1>
                    <field name="x_css" invisible="1"/>
                    <group>
                        <group>
                            <field name="user_id" invisible="1"/>
                            <field name="year" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="month" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="payment_for_league_member" string="League or Member" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                        </group>
                        <group>
                            <field name="subcity_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="wereda_id" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="main_office" attrs="{'readonly': [('state', '!=', 'draft')]}" options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="amount_collected" force_save="1"/>
                            <field name="amount" attrs="{'readonly': [('state', '=', 'submit')]}"/>
                            <field name="estimated_amount_remaining" force_save="1"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Cells" name="cell_payment_ids" attrs="{'invisible': [('state', '=', 'draft')], 'readonly': [('state', '=', 'submit')]}">
                            <field name="cell_payment_ids" attrs="{'readonly': [('state', '=', 'submit')]}">
                                <tree delete="false">
                                    <field name="name"/>
                                    <field name="year"/>
                                    <field name="month"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" attrs="{'invisible': [('state', '=', 'draft')]}">
                                <field name="total_estimated_for_cells" widget="monetary" force_save="1"/>
                                <field name="total_remaining_for_cells" widget="monetary" force_save="1"/>
                                <field name="total_paid_for_cells" widget="monetary" force_save="1"/>
                                <field name="total_paid_for_donors" widget="monetary" force_save="1"/>
                            </group>
                        </page>
                        <page string="Donors" name="donor_ids" attrs="{'invisible': [('state', '=', 'draft')], 'readonly': [('state', '=', 'submit')]}">
                            <field name="donor_ids" attrs="{'readonly': [('state', '=', 'submit')]}">
                                <tree delete="false">
                                    <field name="name"/>
                                    <field name="donor_ids"/>
                                    <field name="supporter_id"/>
                                    <field name="year"/>
                                    <field name="month"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right" attrs="{'invisible': [('state', '=', 'draft')]}">
                                <field name="total_donors" widget="monetary" force_save="1"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="membership_payment_action" model="ir.actions.act_window">
        <field name="name">Members' Payment</field>
        <field name="res_model">membership.payment</field>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="domain">['|', '|', '|', '|', '|', '|',
                            ('main_office.main_admin', '=', uid),
                            ('main_office.main_finance', '=', uid),
                            ('wereda_id.branch_manager', '=', uid),
                            ('subcity_id.parent_manager.id', '=', uid),
                            ('subcity_id.city_id.city_manager', 'in', [uid]),
                            ('subcity_id.city_id.transfer_handler', '=', uid), 
                            ('subcity_id.city_id.responsible_id.system_admin', '=', uid)]</field>
    </record>

    <record id="main_office_payment_graph" model="ir.ui.view">
        <field name="name">Main Office Payment</field>
        <field name="model">membership.payment</field>
        <field name="arch" type="xml">
            <graph string="Main Office Payment">
                <field name="month"/>
                <field name="main_office"/>
                <field name="amount" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="donation_payment_search_report" model="ir.ui.view">
        <field name="name">Donors Payment</field>
        <field name="model">donation.payment</field>
        <field name="arch" type="xml">
            <search string="Donors Payment">
                <group expand="0" string="Group By" colspan="10" col="8">
                    <filter string="Month" name="month" context="{'group_by': 'month'}"/>
                    <filter string="Year" name="year" context="{'group_by': 'year'}"/>
                    <filter string="Supporters or Donors" name="supporter" context="{'group_by': 'for_donor_or_supporter'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="donor_payment_graph" model="ir.ui.view">
        <field name="name">Donor Payment</field>
        <field name="model">donation.payment</field>
        <field name="arch" type="xml">
            <graph string="Donor Payment">
                <field name="month"/>
                <field name="amount" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="donation_payment_tree_report" model="ir.ui.view">
        <field name="name">Donors Payment</field>
        <field name="model">donation.payment</field>
        <field name="arch" type="xml">
            <tree create="false" edit="false" delete="false" duplicate="false">
                <field name="name" readonly="1"/>
                <field name="user_id" invisible="1"/>
                <field name="year" readonly="1"/>
                <field name="month" readonly="1"/>
                <field name="amount" readonly="1"/>
                <field name="donor_ids" readonly="1"/>
                <field name="supporter_id" readonly="1"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="donation_payment_report_action" model="ir.actions.act_window">
        <field name="name">Donors Payment</field>
        <field name="res_model">donation.payment</field>
        <field name="view_mode">tree,pivot,graph</field>
        <field name="search_view_id" ref="donation_payment_search_report"/>
        <field name="view_id" ref="donation_payment_tree_report"/>
        <field name="context">{"search_default_supporter": 1}</field>
        <field name="domain">['|', '|', '|', '|', '|',
                            ('member_cell.cell_admin', '=', uid),
                            ('main_office.main_admin', '=', uid),
                            ('wereda_id.branch_manager', '=', uid),
                            ('subcity_id.parent_manager.id', '=', uid),
                            ('subcity_id.city_id.city_manager', 'in', [uid]),
                            ('subcity_id.city_id.responsible_id.system_admin', '=', uid)]</field>
    </record>

    <menuitem id="membership_payment_menu"
              name="Payment"
              parent="menu_association"
              sequence="70"
              groups="members_custom.member_group_finance"/>

    <menuitem id="donation_payment_menu"
              name="Donors Payment"
              parent="membership_payment_menu"
              action="donor_payment_action"
              sequence="0"/>

    <menuitem id="membership_cell_payment_menu"
              name="Cell Payment"
              parent="membership_payment_menu"
              action="membership_cell_payment_action"
              sequence="1"
              groups="members_custom.member_group_finance"/>

    <menuitem id="membership_wereda_menu"
              name="Main Office Payment"
              parent="membership_payment_menu"
              action="membership_payment_action"
              groups="members_custom.member_group_main_finance"
              sequence="2"/>

    <menuitem id="payment_reporting"
              name="All Payment Reporting"
              parent="menu_report_membership"
              groups="members_custom.member_group_admin"
              sequence="4"/>

    <menuitem id="membership_payment_detail_menu"
              name="Members' Payment"
              parent="payment_reporting"
              action="each_member_payment_menu"
              sequence="1"/>

    <menuitem id="donor_payment_detail_menu"
              name="Donors Payment"
              parent="payment_reporting"
              action="donation_payment_report_action"
              sequence="2"/>

    <menuitem id="league_payment_detail_menu"
              name="Leagues' Payment"
              parent="payment_reporting"
              action="each_league_payment_menu"
              sequence="3"/>

    <menuitem id="payment_fee_configuration_menu"
              name="Payment Fee Configuration"
              parent="members_custom.minor_menus"
              action="payment_fee_configuration_action"
              sequence="5"/>

</odoo>